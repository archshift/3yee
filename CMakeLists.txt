CMAKE_MINIMUM_REQUIRED(VERSION 3.10)

SET(EXENAME 3yee)
PROJECT(${EXENAME})

SET(EMSCRIPTEN FALSE CACHE BOOL "Build with emscripten")
if (NOT ${EMSCRIPTEN})
    FIND_PACKAGE(SDL2 REQUIRED)
    FIND_PACKAGE(GLEW 2.0 REQUIRED)
    FIND_PACKAGE(OpenGL REQUIRED)
endif()

SET(SOURCES
    main.cpp
    shader.cpp
)

if (${EMSCRIPTEN})
    ADD_COMPILE_OPTIONS(-s USE_SDL=2)
    ADD_LINK_OPTIONS(-s USE_SDL=2)
endif()
ADD_COMPILE_OPTIONS(-g -O0 -Wall -Wextra -fno-strict-aliasing)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++17")

ADD_SUBDIRECTORY(glad)
INCLUDE_DIRECTORIES(glad/include)

ADD_SUBDIRECTORY(stb-image)
INCLUDE_DIRECTORIES(stb-image)

ADD_SUBDIRECTORY(imgui)
INCLUDE_DIRECTORIES(imgui/imgui imgui/imgui/examples imgui/imgui/misc/cpp)

ADD_SUBDIRECTORY(glm)
INCLUDE_DIRECTORIES(glm)

INCLUDE_DIRECTORIES(${glm_INCLUDE_DIRS})
ADD_EXECUTABLE(${EXENAME} ${SOURCES})
TARGET_LINK_LIBRARIES(${EXENAME}
    glad
    stb-image
    imgui
    ${glm_LIBRARY}
)

if (NOT ${EMSCRIPTEN})
    TARGET_LINK_LIBRARIES(${EXENAME}
        SDL2::SDL2
        OpenGL::OpenGL
    )
endif()

